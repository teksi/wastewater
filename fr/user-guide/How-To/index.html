

<!DOCTYPE html>
<html class="writer-html5" lang="fr" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3.8. How To &mdash; Documentation TWW dev</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=b46de64f"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../_static/translations.js?v=e6b791cb"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Recherche" href="../../search.html" />
    <link rel="next" title="4. Guide d’administration" href="../../admin-guide/index.html" />
    <link rel="prev" title="3.7.1. History viewer" href="../history/history.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            TWW
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Rechercher docs" aria-label="Rechercher docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../features-guide/index.html">1. TEKSI Assainissement (TWW)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation-guide/index.html">2. TWW Installation Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">3. TWW User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../layerexplanations/index.html">3.1. Aperçu de TWW</a></li>
<li class="toctree-l2"><a class="reference internal" href="../digitizing/index.html">3.2. Digitizing in TWW</a></li>
<li class="toctree-l2"><a class="reference internal" href="../editing/index.html">3.3. Editing in TWW</a></li>
<li class="toctree-l2"><a class="reference internal" href="../length-profile/index.html">3.4. Profils en long</a></li>
<li class="toctree-l2"><a class="reference internal" href="../network-following/index.html">3.5. Outils de poursuite de réseau</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plan-plotting/index.html">3.6. Impression de plans</a></li>
<li class="toctree-l2"><a class="reference internal" href="../history/index.html">3.7. History in TWW</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.8. How To</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setting-default-values">3.8.1. Définir les valeurs par défaut</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-vw-tww-wastewater-structure-labels-work">3.8.2. Comment fonctionnent les labels de la couche <cite>vw_tww_wastewater_structure</cite></a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-translate-a-label-prefix-c-b-i-o">3.8.3. How to translate a label prefix (C, B, I, O)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-check-if-triggers-are-active">3.8.4. How to check if triggers are active</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-run-symbology-functions-manually">3.8.5. How to run symbology functions manually</a></li>
<li class="toctree-l3"><a class="reference internal" href="#manual-label-positioning-for-different-scales">3.8.6. Manual Label-positioning for different scales</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-import-existing-label-positions">3.8.7. How to import existing label-positions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#collecting-a-hydr-geometry-corresponds-to-a-basin-geometry-in-mike">3.8.8. Collecting a hydr_geometry (corresponds to a basin geometry in Mike+)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hydraulic-modeling-of-an-overflow-prank-weir-leapingweir-pump">3.8.9. Hydraulic modeling of an overflow (prank weir / leapingweir / pump)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#overflow-characteristic">3.8.10. Overflow characteristic</a></li>
<li class="toctree-l3"><a class="reference internal" href="#further-informations">3.8.11. Further informations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/index.html">4. Guide d’administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extensions-guide/index.html">5. Official TWW extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tww_swmm/index.html">6. SWMM Data Exchange</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../translation/index.html">7. Traduction</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">TWW</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html"><span class="section-number">3. </span>TWW User Guide</a></li>
      <li class="breadcrumb-item active"><span class="section-number">3.8. </span>How To</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/user-guide/How-To/index.rst.txt" rel="nofollow"> Afficher la source de la page</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <blockquote>
<div></div></blockquote>
<section id="how-to">
<h1><span class="section-number">3.8. </span>How To<a class="headerlink" href="#how-to" title="Lien vers cette rubrique"></a></h1>
<p>Ce guide présente la configuration du module assainissement.</p>
<section id="setting-default-values">
<span id="settingdefaultvalues"></span><h2><span class="section-number">3.8.1. </span>Définir les valeurs par défaut<a class="headerlink" href="#setting-default-values" title="Lien vers cette rubrique"></a></h2>
<p>Si le message suivant apparaît au démarrage du projet “Database production ready check”:</p>
<p>CRITICAL: Error fk_provider or fk_dataowner not set in tww_od.default_values</p>
<p>Alors votre base de données n’est pas encore prête pour la production.</p>
<p>Il est possible de définir des valeurs par défaut pour des champs récurrents comme <cite>fk_provider</cite> ou <cite>fk_dataowner</cite>, ainsi il ne sera plus nécessaire de définir ces champs manuellement pour chaque objet créé.</p>
<p>Un groupe “configuration” est disponible dans le projet:</p>
<figure class="align-default">
<img alt="../../_images/configuration_default_values.png" src="../../_images/configuration_default_values.png" />
</figure>
<ol class="arabic simple">
<li><p>Ouvrir la table d’attributs “Valeurs par défaut”</p></li>
<li><p>Passer en mode édition et sélectionner un nouvel objet</p></li>
<li><p>Sélectionner le nom du champs (actuellement fk_dataowner et fk_provider sont supportés dans le formulaire)</p></li>
</ol>
<figure class="align-default">
<img alt="../../_images/default_values_fieldname_selection.png" src="../../_images/default_values_fieldname_selection.png" />
</figure>
<ol class="arabic simple" start="4">
<li><p>Sélectionner l’organisation qui devrait être utilisée (l’obj_id correspondant sera ajouté à la table).</p></li>
</ol>
<figure class="align-default">
<img alt="../../_images/default_values_organisation_obj_id_selection.png" src="../../_images/default_values_organisation_obj_id_selection.png" />
</figure>
<p>Pour le second avertissement, merci de contacter votre administrateur système.</p>
<p>CRITICAL: Error OID prefix set to “ch000000”. Database not safe for production.</p>
<p>et demander de définir le préfix qui convient pour votre projet.</p>
<p>Pour de plus amples informations, voir <a class="reference internal" href="../../admin-guide/db-production-readiness/index.html#productionreadiness"><span class="std std-ref">Prepare database for production</span></a></p>
<p>Connect all occurences of your field name to <code class="docutils literal notranslate"><span class="pre">tww_app.get_default_values(field_name)</span></code>.
Per default, the fields <code class="docutils literal notranslate"><span class="pre">fk_provider</span></code> and <code class="docutils literal notranslate"><span class="pre">fk_dataowner</span></code> are already connected to the function <code class="docutils literal notranslate"><span class="pre">tww_app.get_default_values(field_name)</span></code>.</p>
<p>Un exemple de script SQL montre comment installer les valeurs par défaut toutes les occurrences d’un même nom de champ <a class="reference external" href="https://github.com/teksi/wastewater/blob/main/datamodel/changelogs/0001/14_default_values.sql">ici</a>)</p>
</section>
<section id="how-vw-tww-wastewater-structure-labels-work">
<h2><span class="section-number">3.8.2. </span>Comment fonctionnent les labels de la couche <cite>vw_tww_wastewater_structure</cite><a class="headerlink" href="#how-vw-tww-wastewater-structure-labels-work" title="Lien vers cette rubrique"></a></h2>
<p>Labeling a manhole with his levels is quite a complex thing. Levels are not stored in the wastewater_structure class itself, but in the cover table and as reachpoint levels with the connected reaches. TWW has therefore 4 calculated fields to be able to label these levels:</p>
<ul class="simple">
<li><p>_cover_label: shows the level / the levels of the cover/s.level of the wastewater structure</p></li>
<li><p>_bottom_label: shows the level / the levels of the wastewater_node(s).bottom_level of the wastewater structure</p></li>
<li><p>_input_label: shows the levels of the reachpoints connected as to_reachpoints to one of the wastewater_nodes of the wastewater_structure</p></li>
<li><p>_output_label: shows the levels of the reachpoints connected as from_reachpoints to one of the wastewater_nodes of the wastewater_structure</p></li>
</ul>
<figure class="align-default">
<img alt="../../_images/tww_labels.jpg" src="../../_images/tww_labels.jpg" />
</figure>
<p>In this example, there are 4 input-reaches to the manhole, but there are only two input-labels (I1, I2). Why?</p>
<p>Answer: in the function, where the _input_label is calculated, can be set a filter so that only reaches with specified function_hierachic (e.g. only pwwf-reaches) are labeled (uses a specific field in the vl-channel_function_hierarchic, documentation follows).
In the example, the 200mm-reaches are swwf-reaches and therefore not labeled.</p>
<p>Which reach is I1, which is I2?</p>
<p>Answer: TWW uses the azimut of the last segment of the reach (for inputs) or the first segement of the reach (for outputs) to define the order of the labels. If you stand in the North to the manhole and go clockwise around the manhole, you will first come to I1 and then later to I2.
In the example, 300 combined-wastewater-reach is I1, 400 wastewater-reach is I2.</p>
</section>
<section id="how-to-translate-a-label-prefix-c-b-i-o">
<h2><span class="section-number">3.8.3. </span>How to translate a label prefix (C, B, I, O)<a class="headerlink" href="#how-to-translate-a-label-prefix-c-b-i-o" title="Lien vers cette rubrique"></a></h2>
<p>To easily translate label prefixes a series of QGIS project variables have been added. If you want to change the prefixes for cover level, bottom level and entry and exit levels, change the following project settings:</p>
<figure class="align-default">
<img alt="../../_images/tww_label_prefix_settings.jpg" src="../../_images/tww_label_prefix_settings.jpg" />
</figure>
<p>To see your changes, you have to rerun the symbology functions manually (see next chapter)</p>
</section>
<section id="how-to-check-if-triggers-are-active">
<h2><span class="section-number">3.8.4. </span>How to check if triggers are active<a class="headerlink" href="#how-to-check-if-triggers-are-active" title="Lien vers cette rubrique"></a></h2>
<p>For some processes such as INTERLIS Imports, a set of triggers are temporarily deactivated to speed up the process.</p>
<ul>
<li><p>Check status of triggers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">tww_app</span><span class="o">.</span><span class="n">check_symbology_triggers_enabled</span><span class="p">();</span>
<span class="n">SELECT</span> <span class="n">tww_app</span><span class="o">.</span><span class="n">check_modification_triggers_enabled</span><span class="p">();</span>
</pre></div>
</div>
</li>
<li><p>Activate / Deactivate triggers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">tww_app</span><span class="o">.</span><span class="n">alter_symbology_triggers</span><span class="p">(</span><span class="s1">&#39;enable&#39;</span><span class="p">);</span>
<span class="n">SELECT</span> <span class="n">tww_app</span><span class="o">.</span><span class="n">alter_symbology_triggers</span><span class="p">(</span><span class="s1">&#39;disable&#39;</span><span class="p">);</span>
<span class="n">SELECT</span> <span class="n">tww_app</span><span class="o">.</span><span class="n">alter_modification_triggers</span><span class="p">(</span><span class="s1">&#39;enable&#39;</span><span class="p">);</span>
<span class="n">SELECT</span> <span class="n">tww_app</span><span class="o">.</span><span class="n">alter_modification_triggers</span><span class="p">(</span><span class="s1">&#39;disable&#39;</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="how-to-run-symbology-functions-manually">
<h2><span class="section-number">3.8.5. </span>How to run symbology functions manually<a class="headerlink" href="#how-to-run-symbology-functions-manually" title="Lien vers cette rubrique"></a></h2>
<p>Sometimes the labels such as bottom, cover or entry/exit levels are not correctly displayed, even if the corresponding attribut is filled in. This happens for example when you import data by INTERLIS Import or another way. Maybe the triggers were temporarily deactivated to speed up the import process.</p>
<ul>
<li><p>Check status of symbology triggers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">tww_app</span><span class="o">.</span><span class="n">check_symbology_triggers_enabled</span><span class="p">();</span>
</pre></div>
</div>
</li>
<li><p>Activate / Deactivate symbology triggers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">tww_app</span><span class="o">.</span><span class="n">alter_symbology_triggers</span><span class="p">(</span><span class="s1">&#39;enable&#39;</span><span class="p">);</span>
<span class="n">SELECT</span> <span class="n">tww_app</span><span class="o">.</span><span class="n">alter_symbology_triggers</span><span class="p">(</span><span class="s1">&#39;disable&#39;</span><span class="p">);</span>
</pre></div>
</div>
</li>
<li><p>Run <strong>label function</strong> for all entities (_label, _cover_label, _bottom_label, _input_label and _output_label):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">tww_app</span><span class="o">.</span><span class="n">update_wastewater_structure_label</span><span class="p">(</span><span class="n">NULL</span><span class="p">,</span> <span class="n">true</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<figure class="align-default">
<img alt="../../_images/tww_label_attributes.jpg" src="../../_images/tww_label_attributes.jpg" />
</figure>
<ul>
<li><p>Run depth calculation for all entities (wastewater_structure._depth):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">tww_app</span><span class="o">.</span><span class="n">update_depth</span><span class="p">(</span><span class="n">NULL</span><span class="p">,</span> <span class="n">true</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ul>
<figure class="align-default">
<img alt="../../_images/tww_system_attributes_depth.jpg" src="../../_images/tww_system_attributes_depth.jpg" />
</figure>
<p>For symbolizing point elements (manholes, special structures etc. and  wastewater_nodes)  with _function_hierarchic and _usage_current the function <cite>update_wastewater_node_symbology</cite> calculates the two tww attributes from the connected reach(es).</p>
<ul>
<li><p>Run <strong>wastewater node symbology</strong> for all entities (calculates function_hierarchic and usage_current from connected reaches and adds result to  wastewater_node._function_hierarchic and   _usage_current):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">tww_app</span><span class="o">.</span><span class="n">update_wastewater_node_symbology</span><span class="p">(</span><span class="n">NULL</span><span class="p">,</span> <span class="n">true</span><span class="p">);</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="manual-label-positioning-for-different-scales">
<h2><span class="section-number">3.8.6. </span>Manual Label-positioning for different scales<a class="headerlink" href="#manual-label-positioning-for-different-scales" title="Lien vers cette rubrique"></a></h2>
<p>QGIS label definition can handle different labels for different scales. This works very well if you work on the screen.
If you have to print plans with labels or if you have to export labels for data exchange (e.g. exchange with RegioGIS-platform), it will often be necessary to determine the label positions manually.
If a label is positioned manually in QGIS, this fixed position applies to every scale. And that’s not always a good result.</p>
<p>Solution</p>
<ul class="simple">
<li><p>Extend the Auxiliary Storage File with new fields for different labelpositions</p></li>
<li><p>Use Rule-based labeling, then you can define different labelpositions for every rule</p></li>
</ul>
<p>In the example below, we want to label the wastewater-structures with a detailed label for network_plan (1:500) and for overviewmap (1:2000).
In the Auxiliary Storage we use the standard fields PositionX and PositionY for the  network_plan labels. For the overviewmap labels we add two new fields.
We name this fields posx2000 and posy2000.</p>
<figure class="align-default">
<img alt="../../_images/man_labeling_newfields.jpg" src="../../_images/man_labeling_newfields.jpg" />
</figure>
<p>Define now rule-based labeling with two rules. In the example the first rule is called WP-Labels (WP = Werkplan = network_plan).
You have not the change something in the placement, because this rule uses the standard positioning-fields.</p>
<figure class="align-default">
<img alt="../../_images/man_labeling_rules.jpg" src="../../_images/man_labeling_rules.jpg" />
</figure>
<p>The second rule is called UP-Labels (UP = Uebersichtsplan = overviewmap). In this rule, you have to change the coordinate fields in the placement-tab.</p>
<figure class="align-default">
<img alt="../../_images/man_labeling_edit_rules.jpg" src="../../_images/man_labeling_edit_rules.jpg" />
</figure>
<figure class="align-default">
<img alt="../../_images/man_labeling_coordinatefield.jpg" src="../../_images/man_labeling_coordinatefield.jpg" />
</figure>
<p>Click on Coordinate X menutool and choose in the field type-menu the auxiliary_storage_user_custom_posx2000 field. Then the similar for Y.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Do not use the <strong>Edit…</strong> menu for defining the coordinate-field. If you use a formula or choose the field via the Edit… menu, QGIS will overwrite the definition everytime you do a manual positioning.</p>
</div>
<p>Now you can move or fix your labels for every rule with different positions with the QGIS <strong>Moves a Label or Diagram</strong>-Tool.</p>
<figure class="align-default">
<img alt="../../_images/man_labeling_labeltools.jpg" src="../../_images/man_labeling_labeltools.jpg" />
</figure>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Your changes are only saved if you save the QGIS-project!</p>
</div>
</section>
<section id="how-to-import-existing-label-positions">
<h2><span class="section-number">3.8.7. </span>How to import existing label-positions<a class="headerlink" href="#how-to-import-existing-label-positions" title="Lien vers cette rubrique"></a></h2>
<p>Good label-positions can be hard work. So you don’t want to loose it.</p>
<ul class="simple">
<li><p>Export your label-positions from your old system in the form obj_id, coordinateX (east), coordinateY (north).</p></li>
<li><p>Add the <strong>.qgd</strong>-file of your project with <strong>Add Vector Layer…</strong> to your project and open the attribute table.</p></li>
</ul>
<figure class="align-default">
<img alt="../../_images/man_labeling_auxtable.jpg" src="../../_images/man_labeling_auxtable.jpg" />
</figure>
<p>If you can not find a .qgd-file, then you have probably not moved or rotated a label before.</p>
<ul class="simple">
<li><p>Change the field-names in your export-data to the field-names in the qgd-file. In the example the obj_id-field must have the name <strong>ASPK</strong>, the coordinate-fields must have the names <strong>labeling_positionx</strong> and <strong>labeling_positiony</strong>.</p></li>
<li><p>Open the export-file in the QGIS-project and copy the rows you want to the table of the qgd-file (this file must be editable).</p></li>
<li><p>Save the qgd-file and remove it from your project, before you remove labels, because QGIS can not save manual label-positions, if the qgd-file is a layer in the project.</p></li>
<li><p>If necessary define the horizontal/vertical alignment of your label-coordinates in the placement of the label definition.</p></li>
</ul>
</section>
<section id="collecting-a-hydr-geometry-corresponds-to-a-basin-geometry-in-mike">
<h2><span class="section-number">3.8.8. </span>Collecting a hydr_geometry (corresponds to a basin geometry in Mike+)<a class="headerlink" href="#collecting-a-hydr-geometry-corresponds-to-a-basin-geometry-in-mike" title="Lien vers cette rubrique"></a></h2>
<p>Note:</p>
<ul class="simple">
<li><p>Wastewater structures with a hydr_geometry have to be defined as special structures (and not as standard manholes).</p></li>
<li><p>The detail geometry can be graphically drawn with the <strong>Digitize action</strong>.</p></li>
</ul>
<p>Action:</p>
<ol class="arabic simple">
<li><p>Select in layer vw_tww_wastewater_structure the wastewater structure with the i-button</p></li>
<li><p>Select the <strong>Wastewater Nodes</strong> tab in the Feature Attributes window</p></li>
</ol>
<p>or in a more direct way: Select the node with the i-button in layer vw_wastewater_node</p>
<ol class="arabic simple" start="3">
<li><p>Expand the part ** additional attributes in special structures**</p></li>
<li><p>Select a hydr_geometry in the fk_hydr_geometry field or use the <strong>+</strong> button to create a new hydr_geometry.</p></li>
</ol>
<figure class="align-default">
<img alt="../../_images/hydr_geometry1.jpg" src="../../_images/hydr_geometry1.jpg" />
</figure>
<ol class="arabic simple" start="5">
<li><p>For a new record: Enter a description in the hydr_geometry - Feature Attributes window. This name is also the name of the table in Mike+.</p></li>
</ol>
<figure class="align-default">
<img alt="../../_images/hydr_geometry2.jpg" src="../../_images/hydr_geometry2.jpg" />
</figure>
<ol class="arabic simple" start="6">
<li><p>With the <strong>Add child object</strong> button, you can now generate the records with which the hydr_geometry is defined analogously to the basin geometry of Mike+ (H, As surface, Ac cross-sectional area).</p></li>
</ol>
<p>In the table view, the overview of the values is easier.</p>
<figure class="align-default">
<img alt="../../_images/hydr_geometry3.jpg" src="../../_images/hydr_geometry3.jpg" />
</figure>
<p>Note:</p>
<ul class="simple">
<li><p>The water depth is the value above the bottom level or the outlet. A hydr_geometry can thus be used for several wastewater structure if they are built similar.</p></li>
<li><p>Be aware to respect the rules in Mike (e.g. continuous increasing cross_section_area)</p></li>
<li><p>As long as the hydr_geometry record is not saved, you see in the Features Attribute window just the Obj_Id in brackets. After saving, you will see the identifier you have entered.</p></li>
</ul>
</section>
<section id="hydraulic-modeling-of-an-overflow-prank-weir-leapingweir-pump">
<h2><span class="section-number">3.8.9. </span>Hydraulic modeling of an overflow (prank weir / leapingweir / pump)<a class="headerlink" href="#hydraulic-modeling-of-an-overflow-prank-weir-leapingweir-pump" title="Lien vers cette rubrique"></a></h2>
<p>There is a special view for overflows, altough it would be possible to edit the overflow-data in layer vw_tww_wastewater_structure.
The advantage of layer vw_tww_overflow: overflows can be visualized, can be found again and are available in lists.</p>
<p>Action:</p>
<p>If it not already exists: In the case of weirs, a second wastewater node has to be created in the wastewater structure.
A second outlet has already been created (green = discharged combined wastewater) and has not yet been linked to any wastewater node in the overflow structure.</p>
<ol class="arabic simple">
<li><p>Select the wastewater structure with the i-button</p></li>
<li><p>Select the wastewater nodes tab in the Feature Attributes window</p></li>
<li><p>Create a second wastewater node with the <strong>Add point child object</strong> button. The light blue note at the top of the map tells you what to do!</p></li>
</ol>
<figure class="align-default">
<img alt="../../_images/overflow1.jpg" src="../../_images/overflow1.jpg" />
</figure>
<ol class="arabic simple" start="4">
<li><p>Click next to outlet 2 to place the second wastewater node.</p></li>
<li><p>The Feature Attributes window for this wastewater node appears. Enter a meaningful identifier (e.g. 1.070-WN2 for wastewater node 2 of the 1.070 special structure). This designation also appears in Mike+. The new wastewater node is saved with OK.</p></li>
</ol>
<figure class="align-default">
<img alt="../../_images/overflow2.jpg" src="../../_images/overflow2.jpg" />
</figure>
<p>Close the Feature Attributes window of the wastewater structure.</p>
<p>To define a new prank weir:</p>
<ol class="arabic simple" start="6">
<li><p>Choose the layer vw_tww_overflow in the layergroup Hydraulic.</p></li>
<li><p>Choose the QGIS standard <strong>Add Point Feature</strong> button and click anyware near to the wastewater_structure</p></li>
</ol>
<div class="admonition hint">
<p class="admonition-title">Indication</p>
<p>Because an overflow itself has no geometry, the place you click has no meaning. The geometry will be defined be the linked from- and to-wastewater nodes, see point 9</p>
</div>
<p>The overflow Feature Attributes window opens.</p>
<ol class="arabic simple" start="8">
<li><p>Enter an identifier and choose the overflow_type.</p></li>
<li><p>Define the two wastewater nodes of the overflow (fk_wastewater_node = from node, fk_overflow_to = to node) by selecting them on the map with the <strong>map identification</strong>-tool.</p></li>
</ol>
<p>The attributes in the upper hydraulic section must be filled in, they will be transferred to Mike+.</p>
<figure class="align-default">
<img alt="../../_images/overflow4.jpg" src="../../_images/overflow4.jpg" />
</figure>
<p>Close all open Feature Attributes windows.</p>
<div class="admonition hint">
<p class="admonition-title">Indication</p>
<p>The new overflow is drawn as dotted line with arrow. If the line does not appear: the line is defined with the QGIS geometry generator symbol. Control the formula of the geometry generator (layer properties/symbology, select the symbol), control first the name of the <strong>vw_wastewater_node</strong> layer. If this layer is renamed, the formula has to be changed with the new name (e.g. <strong>vw_Abwasserknoten</strong>).</p>
</div>
<p>To finish, the 2nd outlet has to be linked to the 2nd wastewater node:</p>
<ol class="arabic simple">
<li><p>Select the TWW tool <strong>Connect wastewater networkelements</strong>.</p></li>
<li><p>Click on the reach near to the outlet</p></li>
<li><p>Click on the wastewater node</p></li>
<li><p>Confirm that the connection is created for the <strong>from reach point</strong>.</p></li>
</ol>
<figure class="align-default">
<img alt="../../_images/connect_2_node.jpg" src="../../_images/connect_2_node.jpg" />
</figure>
</section>
<section id="overflow-characteristic">
<h2><span class="section-number">3.8.10. </span>Overflow characteristic<a class="headerlink" href="#overflow-characteristic" title="Lien vers cette rubrique"></a></h2>
<p>In the case of a leaping weir, a pump or under special conditions, an overflow characteristic can be defined for the overflow:</p>
<p>You can select an existing characteristic in the field fk_overflow_char or you create a new characteristic with the green + button.</p>
<p>The Feature Attributes window for the overflow characteristic appears:</p>
<figure class="align-default">
<img alt="../../_images/overflow_char1.jpg" src="../../_images/overflow_char1.jpg" />
</figure>
<ol class="arabic simple">
<li><p>Here too, the identifer is later adopted in Mike+ as a table name for a QH relationship, which is used, for example, in a local controller.</p></li>
<li><p>Define the necessary HQ or QQ values with the <strong>add child object</strong> button. Be sure to choose the correct tab corresponding to the choice in <strong>kind_overflow_char</strong></p></li>
</ol>
</section>
<section id="further-informations">
<h2><span class="section-number">3.8.11. </span>Further informations<a class="headerlink" href="#further-informations" title="Lien vers cette rubrique"></a></h2>
<p>Further Q &amp; A’s you can find in the
<a class="reference external" href="https://github.com/orgs/teksi/discussions/categories/q-a">TWW Discussion section</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pied de page">
        <a href="../history/history.html" class="btn btn-neutral float-left" title="3.7.1. History viewer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Précédent</a>
        <a href="../../admin-guide/index.html" class="btn btn-neutral float-right" title="4. Guide d’administration" accesskey="n" rel="next">Suivant <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Droits d'auteur 2024, The TWW Project www.teksi.ch.</p>
  </div>

  Compilé avec <a href="https://www.sphinx-doc.org/">Sphinx</a> en utilisant un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">thème</a>
    fourni par <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>